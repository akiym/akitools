# -*- coding: utf-8 -*-
import os
import sys
import time
import re
import struct
import socket

p = lambda x: struct.pack("<I", x)
u = lambda x: struct.unpack("<I", x)[0]

def connect(host, port):
    return socket.create_connection((host, port))

def recvuntil(st, debug=False):
    ret = ""
    while st not in ret:
        lret = s.recv(1)
        if debug and len(lret) > 0:
            print lret
        ret += lret
    return ret

def recvn(n):
    ret = ""
    while len(ret) != n:
        ret += s.recv(1)
    return ret

def interact():
    import telnetlib
    t = telnetlib.Telnet()
    t.sock = s
    t.interact()

def process(*cmd):
    import subprocess
    p = subprocess.Popen(cmd, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    return p.communicate()[0]


REMOTE = len(sys.argv) >= 2 and sys.argv[1] == 'r'

if REMOTE:
    host = ''
    port = 0
else:
    host = '127.0.0.1'
    port = 4000

s = connect(host, port)
payload = (
    ''
)
s.send(payload)
interact()
